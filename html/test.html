<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Turn checkboxes and radio buttons in toggle switches.">
    <meta name="author" content="Mattia Larentis, Emanuele Marchi and Peter Stein">
    <title>checkbox全选/反选</title>
    <style>
        .classred{ color: red; }
        .classblue{ color: blue; }
        .classgrren{ color: green;}
    </style>
</head>
<body>
<form id="test-form" action="test">
    <legend>请选择想要学习的编程语言：</legend>
    <fieldset>
        <p><label class="selectAll"><input type="checkbox"> <span class="selectAll">全选</span><span class="deselectAll">全不选</span></label> <a href="#0" class="invertSelect">反选</a></p>
        <p><label><input type="checkbox" name="lang" value="javascript"> JavaScript</label></p>
        <p><label><input type="checkbox" name="lang" value="python"> Python</label></p>
        <p><label><input type="checkbox" name="lang" value="ruby"> Ruby</label></p>
        <p><label><input type="checkbox" name="lang" value="haskell"> Haskell</label></p>
        <p><label><input type="checkbox" name="lang" value="scheme"> Scheme</label></p>
        <p><button type="submit">Submit</button></p>
    </fieldset>
</form>
</body>
<script src="../node_modules/jquery/dist/jquery.min.js"></script>
<script type="text/javascript">
    var
        form = $('#test-form'),
        langs = form.find('[name=lang]'),
        selectAll = form.find('label.selectAll :checkbox'),
        selectAllLabel = form.find('label.selectAll span.selectAll'),
        deselectAllLabel = form.find('label.selectAll span.deselectAll'),
        invertSelect = form.find('a.invertSelect');

    // 重置初始化状态:
    form.find('*').show().off();
    form.find(':checkbox').prop('checked', false).off();
    deselectAllLabel.hide();
    // 拦截form提交事件:
    form.off().submit(function (e) {
        e.preventDefault();
        alert(form.serialize());
    });

    // 勾选事件
    selectAll.click(function () {
        if (this.checked === true) {
            selectAllLabel.hide();
            deselectAllLabel.show();
            langs.prop("checked", true);

        } else {

            // 全不选中
            selectAllLabel.show();
            deselectAllLabel.hide();
            langs.prop("checked", false);
        }
    });

    // 反选事件
    invertSelect.click(function () {
        langs.map(function () {
            this.checked = !this.checked;
        });

        checkStatus();
    });

    // 单个选中事件
    langs.click(function () {
        checkStatus();
    });


    // check whether select all
    function checkStatus() {

        // check status
        var whether = true;
        langs.map(function () {
            console.log(this);
            if ($(this).is(':checked') === false) {
//                OR
//                if (this.checked === false) {
//                checkbox固有属性checked
                whether = false;
                return false;
            }
        });

        // change status
        if (whether && !selectAll.is(":checked")) {
            selectAllLabel.hide();
            deselectAllLabel.show();
            selectAll.prop('checked', true);

        }
        if (!whether && selectAll.is(":checked")) {
            selectAllLabel.show();
            deselectAllLabel.hide();
            selectAll.prop('checked', false);
        }
    }
</script>
</html>